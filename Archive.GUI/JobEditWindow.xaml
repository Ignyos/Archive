<Window x:Class="Archive.GUI.JobEditWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
        Title="Edit Backup Job" Height="800" Width="700"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        MinHeight="800" MinWidth="700">
    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Job Name -->
        <StackPanel Grid.Row="0" Margin="0,0,0,10">
            <Label Content="Job Name:" FontWeight="Bold"/>
            <TextBox x:Name="TxtJobName" Text="{Binding Name}" Height="25"/>
        </StackPanel>

        <!-- Description -->
        <StackPanel Grid.Row="1" Margin="0,0,0,10">
            <Label Content="Description (Optional):" FontWeight="Bold"/>
            <TextBox x:Name="TxtDescription" Text="{Binding Description}" Height="60" TextWrapping="Wrap" AcceptsReturn="True"/>
        </StackPanel>

        <!-- Source Path -->
        <StackPanel Grid.Row="2" Margin="0,0,0,10">
            <Label Content="Source Folder:" FontWeight="Bold"/>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBox x:Name="TxtSourcePath" Text="{Binding SourcePath}" Height="25" Grid.Column="0"/>
                <Button Content="Browse..." Width="80" Height="25" Margin="5,0,0,0" Grid.Column="1" Click="BtnBrowseSource_Click"/>
            </Grid>
        </StackPanel>

        <!-- Destination Path -->
        <StackPanel Grid.Row="3" Margin="0,0,0,10">
            <Label Content="Destination Folder:" FontWeight="Bold"/>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBox x:Name="TxtDestinationPath" Text="{Binding DestinationPath}" Height="25" Grid.Column="0"/>
                <Button Content="Browse..." Width="80" Height="25" Margin="5,0,0,0" Grid.Column="1" Click="BtnBrowseDestination_Click"/>
            </Grid>
        </StackPanel>

        <!-- Job Enabled -->
        <StackPanel Grid.Row="4" Margin="0,0,0,15">
            <CheckBox x:Name="ChkEnabled" Content="Job Enabled" IsChecked="{Binding Enabled}" FontWeight="Bold" Margin="0,0,0,8"/>
        </StackPanel>

        <!-- Options -->
        <GroupBox Grid.Row="5" Header="Sync Options" Margin="0,0,0,15" Padding="10">
            <StackPanel>
                <CheckBox x:Name="ChkRecursive" Content="Include subdirectories (recursive)" IsChecked="{Binding Options.Recursive}" Margin="0,0,0,8"/>
                <CheckBox x:Name="ChkDeleteOrphaned" Content="Delete files in destination that don't exist in source" IsChecked="{Binding Options.DeleteOrphaned}" Margin="0,0,0,8"/>
                <CheckBox x:Name="ChkVerify" Content="Verify files after copying (slower but safer)" IsChecked="{Binding Options.VerifyAfterCopy}"/>
            </StackPanel>
        </GroupBox>

        <!-- Schedule -->
        <GroupBox Grid.Row="6" Header="Schedule" Margin="0,0,0,15" Padding="10">
            <StackPanel>
                <CheckBox x:Name="ChkScheduleEnabled" Content="Enable automatic scheduling" IsChecked="{Binding Schedule.Enabled}" Margin="0,0,0,10"/>
                
                <Label Content="Run on days:" FontWeight="Bold" Margin="0,5,0,5" IsEnabled="{Binding IsChecked, ElementName=ChkScheduleEnabled}"/>
                <WrapPanel Margin="0,0,0,10">
                    <CheckBox x:Name="ChkMonday" Content="Mon" Margin="0,0,10,5" Width="60" IsEnabled="{Binding IsChecked, ElementName=ChkScheduleEnabled}"/>
                    <CheckBox x:Name="ChkTuesday" Content="Tue" Margin="0,0,10,5" Width="60" IsEnabled="{Binding IsChecked, ElementName=ChkScheduleEnabled}"/>
                    <CheckBox x:Name="ChkWednesday" Content="Wed" Margin="0,0,10,5" Width="60" IsEnabled="{Binding IsChecked, ElementName=ChkScheduleEnabled}"/>
                    <CheckBox x:Name="ChkThursday" Content="Thu" Margin="0,0,10,5" Width="60" IsEnabled="{Binding IsChecked, ElementName=ChkScheduleEnabled}"/>
                    <CheckBox x:Name="ChkFriday" Content="Fri" Margin="0,0,10,5" Width="60" IsEnabled="{Binding IsChecked, ElementName=ChkScheduleEnabled}"/>
                    <CheckBox x:Name="ChkSaturday" Content="Sat" Margin="0,0,10,5" Width="60" IsEnabled="{Binding IsChecked, ElementName=ChkScheduleEnabled}"/>
                    <CheckBox x:Name="ChkSunday" Content="Sun" Margin="0,0,10,5" Width="60" IsEnabled="{Binding IsChecked, ElementName=ChkScheduleEnabled}"/>
                </WrapPanel>

                <Label Content="Time Window:" FontWeight="Bold" Margin="0,5,0,5" IsEnabled="{Binding IsChecked, ElementName=ChkScheduleEnabled}"/>
                <Grid Margin="0,0,0,10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Label Content="Start Time:" Grid.Column="0" Margin="0,0,5,0" IsEnabled="{Binding IsChecked, ElementName=ChkScheduleEnabled}"/>
                    <xctk:TimePicker x:Name="TxtStartTime" Grid.Column="1" Height="25" Width="120" HorizontalAlignment="Left" 
                                     Format="ShortTime" ShowButtonSpinner="False" IsEnabled="{Binding IsChecked, ElementName=ChkScheduleEnabled}"/>
                    <Label Content="Cutoff Time (Optional):" Grid.Column="2" Margin="5,0,5,0" IsEnabled="{Binding IsChecked, ElementName=ChkScheduleEnabled}"/>
                    <TextBlock Grid.Column="3" VerticalAlignment="Center" Margin="0,0,5,0" 
                               ToolTip="Optional: If specified, jobs will only start within the time window and running jobs that reach the cutoff time will be stopped. If omitted, jobs can run until completion without time restrictions."
                               IsEnabled="{Binding IsChecked, ElementName=ChkScheduleEnabled}">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Setter Property="Text" Value="ℹ️"/>
                                <Setter Property="Foreground" Value="#0066CC"/>
                                <Setter Property="Cursor" Value="Help"/>
                                <Setter Property="FontSize" Value="14"/>
                                <Style.Triggers>
                                    <Trigger Property="IsEnabled" Value="False">
                                        <Setter Property="Foreground" Value="Gray"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                    <StackPanel Grid.Column="4" Orientation="Horizontal">
                        <xctk:TimePicker x:Name="TxtEndTime" Height="25" Width="120" HorizontalAlignment="Left" 
                                         Format="ShortTime" ShowButtonSpinner="False" IsEnabled="{Binding IsChecked, ElementName=ChkScheduleEnabled}"/>
                        <Button Content="Clear" Height="25" Width="50" Margin="5,0,0,0" 
                                Click="BtnClearCutoff_Click" IsEnabled="{Binding IsChecked, ElementName=ChkScheduleEnabled}"
                                ToolTip="Clear cutoff time to allow jobs to run without time restrictions"/>
                    </StackPanel>
                </Grid>
                <TextBlock Margin="0,0,0,5" FontSize="10" Foreground="Gray" TextWrapping="Wrap" IsEnabled="{Binding IsChecked, ElementName=ChkScheduleEnabled}">
                    Jobs start at the specified time. If a cutoff time is set, running jobs will be stopped when it's reached.
                </TextBlock>
            </StackPanel>
        </GroupBox>

        <!-- Buttons -->
        <StackPanel Grid.Row="7" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button Content="Preview Operations..." Width="140" Height="30" Margin="0,0,5,0" Click="BtnPreview_Click"/>
            <Button Content="OK" Width="80" Height="30" Margin="0,0,5,0" Click="BtnOK_Click" IsDefault="True"/>
            <Button Content="Cancel" Width="80" Height="30" Click="BtnCancel_Click" IsCancel="True"/>
        </StackPanel>
    </Grid>
</Window>
