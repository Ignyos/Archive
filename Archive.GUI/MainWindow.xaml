<Window x:Class="Archive.GUI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Archive.GUI"
        mc:Ignorable="d"
        Title="Archive - Backup Manager" Height="600" Width="900"
        WindowStartupLocation="CenterScreen">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Menu Bar -->
        <Menu Grid.Row="0">
            <MenuItem Header="_File">
                <MenuItem Header="_New Job..." Click="BtnAddJob_Click"/>
                <Separator/>
                <MenuItem Header="_Settings..." Click="MenuSettings_Click"/>
            </MenuItem>
            <MenuItem Header="_Help">
                <MenuItem Header="_About" Click="MenuAbout_Click"/>
            </MenuItem>
        </Menu>

        <!-- Main Content -->
        <Grid Grid.Row="1" Margin="10" MouseDown="Grid_MouseDown">
        <!-- Job List -->
        <DataGrid x:Name="JobsDataGrid" 
                  AutoGenerateColumns="False"
                  SelectionMode="Single"
                  CanUserAddRows="False"
                  IsReadOnly="True"
                  SelectionChanged="JobsDataGrid_SelectionChanged"
                  MouseDoubleClick="JobsDataGrid_MouseDoubleClick"
                  KeyDown="JobsDataGrid_KeyDown"
                  ContextMenuOpening="JobsDataGrid_ContextMenuOpening"
                  HeadersVisibility="Column"
                  GridLinesVisibility="None"
                  BorderThickness="1"
                  Padding="0"
                  AlternatingRowBackground="#F9F9F9"
                  RowBackground="White">
            <DataGrid.ColumnHeaderStyle>
                <Style TargetType="DataGridColumnHeader">
                    <Setter Property="Padding" Value="12,8,12,8"/>
                    <Setter Property="Background" Value="#F0F0F0"/>
                    <Setter Property="BorderBrush" Value="#CCCCCC"/>
                    <Setter Property="BorderThickness" Value="0,0,1,1"/>
                </Style>
            </DataGrid.ColumnHeaderStyle>
            <DataGrid.CellStyle>
                <Style TargetType="DataGridCell">
                    <Setter Property="Padding" Value="12,8,12,8"/>
                    <Setter Property="BorderThickness" Value="0"/>
                    <Style.Triggers>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter Property="Background" Value="#E6F3FF"/>
                            <Setter Property="Foreground" Value="Black"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </DataGrid.CellStyle>
            <DataGrid.RowStyle>
                <Style TargetType="DataGridRow">
                    <Style.Triggers>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter Property="Background" Value="#E6F3FF"/>
                            <Setter Property="Foreground" Value="Black"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </DataGrid.RowStyle>
            <DataGrid.ContextMenu>
                <ContextMenu x:Name="DataGridContextMenu">
                    <MenuItem x:Name="MenuAddJob" Header="Add Job..." Click="BtnAddJob_Click"/>
                    <MenuItem x:Name="MenuEditJob" Header="Edit Job" Click="BtnEditJob_Click"/>
                    <MenuItem x:Name="MenuDeleteJob" Header="Delete Job" Click="BtnDeleteJob_Click"/>
                    <Separator x:Name="MenuSeparator1"/>
                    <MenuItem x:Name="MenuRunJob" Header="Run Now" Click="BtnRunJob_Click"/>
                    <MenuItem x:Name="MenuStopJob" Header="Stop Job" Click="BtnStopJob_Click"/>
                    <Separator x:Name="MenuSeparator2"/>
                    <MenuItem x:Name="MenuViewHistory" Header="View History" Click="ContextMenu_ViewHistory_Click"/>
                </ContextMenu>
            </DataGrid.ContextMenu>
            <DataGrid.Columns>
                <DataGridTextColumn Header="Status" Width="80" IsReadOnly="True">
                    <DataGridTextColumn.Binding>
                        <Binding Path="IsRunning">
                            <Binding.Converter>
                                <local:BoolToStatusConverter/>
                            </Binding.Converter>
                        </Binding>
                    </DataGridTextColumn.Binding>
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="Padding" Value="12,8,12,8"/>
                            <Setter Property="FontWeight" Value="Bold"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsRunning}" Value="True">
                                    <Setter Property="Foreground" Value="#0066CC"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridCheckBoxColumn Header="Enabled" Binding="{Binding Enabled}" Width="70">
                    <DataGridCheckBoxColumn.ElementStyle>
                        <Style TargetType="CheckBox">
                            <Setter Property="Margin" Value="12,0,12,0"/>
                            <Setter Property="VerticalAlignment" Value="Center"/>
                        </Style>
                    </DataGridCheckBoxColumn.ElementStyle>
                </DataGridCheckBoxColumn>
                <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="200">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="Padding" Value="12,8,12,8"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="*">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="Padding" Value="12,8,12,8"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Last Run" Binding="{Binding LastRunTime, StringFormat='{}{0:g}'}" Width="150">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="Padding" Value="12,8,12,8"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTemplateColumn Header="History" Width="100">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Padding="12,8,12,8">
                                <Hyperlink Click="BtnViewHistory_Click" Tag="{Binding}">
                                    View History
                                </Hyperlink>
                            </TextBlock>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>
        </Grid>

        <!-- Status Bar -->
        <StatusBar Grid.Row="2" Height="24">
            <StatusBarItem>
                <TextBlock x:Name="StatusBarText" Text="Checking for updates..." />
            </StatusBarItem>
            <StatusBarItem x:Name="UpdateButtonItem" Visibility="Collapsed" HorizontalAlignment="Right">
                <Button x:Name="BtnDownloadUpdate" 
                        Content="Download Latest" 
                        Click="BtnDownloadUpdate_Click"
                        Padding="8,2"
                        Background="#0078D4"
                        Foreground="White"
                        BorderThickness="0"
                        Cursor="Hand"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
